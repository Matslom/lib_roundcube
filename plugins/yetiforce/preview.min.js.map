{"version":3,"file":"preview.min.js","sources":["preview.js"],"sourcesContent":["'use strict';\n/* {[The file is published on the basis of MIT License]} */\nif (window.rcmail) {\n\trcmail.addEventListener('init', function () {\n\t\trcmail.crm = rcmail.getCrmWindow();\n\t\tif (rcmail.env.uid) {\n\t\t\trcmail.loadActionBar();\n\t\t}\n\t\trcmail.env.message_commands.push('yetiforce.importICS');\n\t\trcmail.register_command(\n\t\t\t'yetiforce.importICS',\n\t\t\tfunction (props, type) {\n\t\t\t\trcmail.importICS(props, type);\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t\trcmail.register_command(\n\t\t\t'plugin.yetiforce.addSenderToList',\n\t\t\tfunction (props) {\n\t\t\t\trcmail.addSenderToList(props);\n\t\t\t},\n\t\t\trcmail.env.uid\n\t\t);\n\t\trcmail.register_command(\n\t\t\t'plugin.yetiforce.loadMailAnalysis',\n\t\t\tfunction (props) {\n\t\t\t\trcmail.loadMailAnalysis(props);\n\t\t\t},\n\t\t\trcmail.env.uid\n\t\t);\n\t\trcmail.addEventListener('plugin.yetiforce.showMailAnalysis', function (content) {\n\t\t\trcmail.showMailAnalysis(content);\n\t\t});\n\t\tif (rcmail.message_list) {\n\t\t\trcmail.message_list.addEventListener('select', function (list) {\n\t\t\t\trcmail.enable_command('plugin.yetiforce.addSenderToList', list.get_selection(false).length > 0);\n\t\t\t\trcmail.enable_command('plugin.yetiforce.loadMailAnalysis', list.get_selection(false).length > 0);\n\t\t\t});\n\t\t\trcmail.addEventListener('listupdate', function () {\n\t\t\t\tlet btns = $('#toolbar-menu .js-white-list-btn');\n\t\t\t\tif (rcmail.env.mailbox === rcmail.env.junk_mailbox) {\n\t\t\t\t\tbtns.hide();\n\t\t\t\t} else {\n\t\t\t\t\tbtns.show();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (rcmail.env.layout == 'widescreen') {\n\t\t\tif (rcmail.gui_objects.messagelist) {\n\t\t\t\trcmail.addEventListener('insertrow', function (evt) {\n\t\t\t\t\tif (typeof rcmail.env.yf_rblList[evt.uid] !== 'undefined') {\n\t\t\t\t\t\tevt.row.obj.style.backgroundColor = rcmail.env.yf_rblList[evt.uid];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tevt.row.obj.style.backgroundColor = '#eaeaea';\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof rcmail.env.yf_senderList[evt.uid] !== 'undefined') {\n\t\t\t\t\t\t$('.fromto', evt.row.obj).prepend(\n\t\t\t\t\t\t\t$('<span class=\"sender-alert-icon\"/>').html(rcmail.env.yf_senderList[evt.uid])\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n}\n// Add sender to list action\nrcube_webmail.prototype.addSenderToList = function (props) {\n\tthis.http_post(\n\t\t'plugin.yetiforce-addSenderToList',\n\t\tthis.selection_post_data({\n\t\t\t_props: props\n\t\t}),\n\t\tthis.set_busy(true, 'loading')\n\t);\n};\nrcube_webmail.prototype.addSenderToListMove = function (mbox) {\n\tthis.move_messages(mbox);\n};\n// import ICS file action\nrcube_webmail.prototype.importICS = function (part, type) {\n\tthis.http_post(\n\t\t'plugin.yetiforce-importIcs',\n\t\t{\n\t\t\t_mbox: rcmail.env.mailbox,\n\t\t\t_uid: rcmail.env.uid,\n\t\t\t_part: part,\n\t\t\t_type: type,\n\t\t\t_mailId: this.mailId\n\t\t},\n\t\tthis.set_busy(true, 'loading')\n\t);\n};\nrcube_webmail.prototype.loadActionBar = function () {\n\tthis.crmContent = $('#ytActionBarContent');\n\trcmail.crm.AppConnector.request({\n\t\tmodule: 'OSSMail',\n\t\tview: 'MailActionBar',\n\t\tuid: rcmail.env.uid,\n\t\tfolder: rcmail.env.mailbox,\n\t\trcId: rcmail.env.user_id\n\t}).done(function (response) {\n\t\trcmail.crmContent.find('.ytHeader').html(response);\n\t\t$('#messagecontent').css('top', rcmail.crmContent.outerHeight() + $('#messageheader').outerHeight() + 'px');\n\t\trcmail.registerEvents();\n\t});\n};\nrcube_webmail.prototype.registerEvents = function () {\n\tthis.mailId = this.crmContent.find('#mailActionBarID').val();\n\tthis.registerAddRecord();\n\tthis.registerAddReletedRecord();\n\tthis.registerSelectRecord();\n\tthis.registerRemoveRecord();\n\tthis.registerImportMail();\n\trcmail.crm.app.registerPopover(this.crmContent.closest('body'));\n\trcmail.crm.app.registerIframeAndMoreContent(this.crmContent.closest('body'));\n\tvar block = this.crmContent.find('.ytHeader .js-data');\n\tthis.crmContent.find('.hideBtn').click(function () {\n\t\tvar button = $(this);\n\t\tvar icon = button.find('span');\n\t\tif (button.data('type') == '0') {\n\t\t\tbutton.data('type', '1');\n\t\t\ticon.removeClass('fa-chevron-circle-up').addClass('fa-chevron-circle-down');\n\t\t} else {\n\t\t\tbutton.data('type', '0');\n\t\t\ticon.removeClass('fa-chevron-circle-down').addClass('fa-chevron-circle-up');\n\t\t}\n\t\tblock.toggle();\n\t\t$(window).trigger('resize');\n\t});\n};\nrcube_webmail.prototype.registerImportMail = function () {\n\tlet clicked = false;\n\tlet importButton = rcmail.crmContent.find('.importMail');\n\timportButton.click(function (e) {\n\t\tif (clicked) return false;\n\t\tclicked = true;\n\t\timportButton.addClass('d-none');\n\t\trcmail.crm.app.showNotify({\n\t\t\ttext: rcmail.crm.app.vtranslate('StartedDownloadingEmail'),\n\t\t\ttype: 'info'\n\t\t});\n\t\trcmail.crm.AppConnector.request({\n\t\t\tmodule: 'OSSMail',\n\t\t\taction: 'ImportMail',\n\t\t\tuid: rcmail.env.uid,\n\t\t\tfolder: rcmail.env.mailbox,\n\t\t\trcId: rcmail.env.user_id\n\t\t})\n\t\t\t.done(function () {\n\t\t\t\trcmail.loadActionBar();\n\t\t\t\trcmail.crm.app.showNotify({\n\t\t\t\t\ttext: rcmail.crm.app.vtranslate('AddFindEmailInRecord'),\n\t\t\t\t\ttype: 'success'\n\t\t\t\t});\n\t\t\t})\n\t\t\t.fail(function () {\n\t\t\t\tclicked = false;\n\t\t\t});\n\t});\n};\nrcube_webmail.prototype.registerRemoveRecord = function () {\n\trcmail.crmContent.find('button.removeRecord').click(function (e) {\n\t\trcmail.removeRecord($(e.currentTarget).closest('.rowRelatedRecord').data('id'));\n\t});\n};\nrcube_webmail.prototype.registerSelectRecord = function () {\n\trcmail.crmContent.find('button.selectRecord').click(function (e) {\n\t\tlet relationSelect = rcmail.crmContent.find('#addRelationSelect').val();\n\t\tlet getCacheModule = rcmail.crm.app.moduleCacheGet('selectedModuleName');\n\t\tif (getCacheModule === 'undefined' || relationSelect !== getCacheModule) {\n\t\t\trcmail.crm.app.moduleCacheSet('selectedModuleName', relationSelect);\n\t\t}\n\t\tlet relParams = {\n\t\t\tmailId: rcmail.mailId\n\t\t};\n\t\tif ($(this).data('type') == 0) {\n\t\t\tvar module = $(this).closest('.js-head-container').find('.module').val();\n\t\t\tif (module === null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else {\n\t\t\tvar module = $(this).data('module');\n\t\t\trelParams.crmid = $(this).closest('.rowRelatedRecord').data('id');\n\t\t\trelParams.mod = $(this).closest('.rowRelatedRecord').data('module');\n\t\t\trelParams.newModule = module;\n\t\t}\n\t\trcmail.showPopup(\n\t\t\t{\n\t\t\t\tmodule: module,\n\t\t\t\tsrc_module: 'OSSMailView',\n\t\t\t\tsrc_record: rcmail.mailId\n\t\t\t},\n\t\t\trelParams\n\t\t);\n\t});\n};\nrcube_webmail.prototype.registerAddReletedRecord = function () {\n\trcmail.crmContent.find('button.addRelatedRecord').click(function (e) {\n\t\tlet targetElement = $(e.currentTarget);\n\t\tlet row = targetElement.closest('.rowRelatedRecord');\n\t\trcmail.showQuickCreateForm(targetElement.data('module'), row.data('id'), {\n\t\t\tsourceModule: row.data('module')\n\t\t});\n\t});\n};\nrcube_webmail.prototype.registerAddRecord = function () {\n\tlet getCacheModule = rcmail.crm.app.moduleCacheGet('selectedModuleName');\n\tif (getCacheModule) {\n\t\trcmail.crmContent.find('#addRelationSelect').val(getCacheModule);\n\t}\n\trcmail.crmContent.find('button.addRecord').click(function (e) {\n\t\tlet relationSelect = rcmail.crmContent.find('#addRelationSelect').val();\n\t\tif (getCacheModule === 'undefined' || relationSelect !== getCacheModule) {\n\t\t\trcmail.crm.app.moduleCacheSet('selectedModuleName', relationSelect);\n\t\t}\n\t\tlet col = $(e.currentTarget).closest('.js-head-container');\n\t\tlet selectValue = col.find('.module').val();\n\t\tif (selectValue !== null) {\n\t\t\tlet relatedRecords = [];\n\t\t\trcmail.crmContent\n\t\t\t\t.find('.js-data')\n\t\t\t\t.find('.rowRelatedRecord')\n\t\t\t\t.each((i, record) => {\n\t\t\t\t\tlet data = $(record).data();\n\t\t\t\t\trelatedRecords.push({\n\t\t\t\t\t\tmodule: data.module,\n\t\t\t\t\t\tid: data.id\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\trcmail.showQuickCreateForm(selectValue, rcmail.mailId, { relatedRecords: relatedRecords });\n\t\t}\n\t});\n};\nrcube_webmail.prototype.removeRecord = function (crmid) {\n\trcmail.crm.AppConnector.request({\n\t\tasync: false,\n\t\tdataType: 'json',\n\t\tdata: {\n\t\t\tmodule: 'OSSMail',\n\t\t\taction: 'ExecuteActions',\n\t\t\tmode: 'removeRelated',\n\t\t\tparams: {\n\t\t\t\tmailId: rcmail.mailId,\n\t\t\t\tcrmid: crmid\n\t\t\t}\n\t\t}\n\t}).done(function (data) {\n\t\tlet response = data['result'];\n\t\tlet notifyParams = {\n\t\t\ttext: response['data'],\n\t\t\tanimation: 'show'\n\t\t};\n\t\tif (response['success']) {\n\t\t\tnotifyParams = {\n\t\t\t\ttext: response['data'],\n\t\t\t\ttype: 'info',\n\t\t\t\tanimation: 'show'\n\t\t\t};\n\t\t}\n\t\trcmail.crm.app.showNotify(notifyParams);\n\t\trcmail.loadActionBar();\n\t});\n};\nrcube_webmail.prototype.showPopup = function (params, actionsParams) {\n\tactionsParams['newModule'] = params['module'];\n\trcmail.crm.app.showRecordsList(params, (modal, instance) => {\n\t\tinstance.setSelectEvent((responseData, e) => {\n\t\t\tactionsParams['newCrmId'] = responseData.id;\n\t\t\trcmail.crm.AppConnector.request({\n\t\t\t\tasync: false,\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: {\n\t\t\t\t\tmodule: 'OSSMail',\n\t\t\t\t\taction: 'ExecuteActions',\n\t\t\t\t\tmode: 'addRelated',\n\t\t\t\t\tparams: actionsParams\n\t\t\t\t}\n\t\t\t}).done(function (data) {\n\t\t\t\tlet response = data['result'];\n\t\t\t\tif (response['success']) {\n\t\t\t\t\tvar notifyParams = {\n\t\t\t\t\t\ttext: response['data'],\n\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t\tanimation: 'show'\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tvar notifyParams = {\n\t\t\t\t\t\ttext: response['data'],\n\t\t\t\t\t\tanimation: 'show'\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\trcmail.crm.app.showNotify(notifyParams);\n\t\t\t\trcmail.loadActionBar();\n\t\t\t});\n\t\t});\n\t});\n};\nrcube_webmail.prototype.showQuickCreateForm = function (moduleName, record, params = {}) {\n\tlet relatedParams = {},\n\t\tsourceModule = 'OSSMailView';\n\tif (params['sourceModule']) {\n\t\tsourceModule = params['sourceModule'];\n\t}\n\tconst postShown = function (data) {\n\t\t$('<input type=\"hidden\" name=\"sourceModule\" value=\"' + sourceModule + '\" />').appendTo(data);\n\t\t$('<input type=\"hidden\" name=\"sourceRecord\" value=\"' + record + '\" />').appendTo(data);\n\t\t$('<input type=\"hidden\" name=\"relationOperation\" value=\"true\" />').appendTo(data);\n\t};\n\tconst ids = {\n\t\tlink: 'modulesLevel0',\n\t\tprocess: 'modulesLevel1',\n\t\tsubprocess: 'modulesLevel2',\n\t\tsubprocess_sl: 'modulesLevel3',\n\t\tlinkextend: 'modulesLevel4'\n\t};\n\tfor (var i in ids) {\n\t\tvar element = rcmail.crmContent.find('#' + ids[i]);\n\t\tvar value = element.length ? JSON.parse(element.val()) : [];\n\t\tif ($.inArray(sourceModule, value) >= 0) {\n\t\t\trelatedParams[i] = record;\n\t\t}\n\t}\n\tconst fillNameFields = (first) => {\n\t\tconst nameData = rcmail.env.yf_fromName.split(' ');\n\t\tconst firstName = nameData.shift();\n\t\tconst lastName = nameData.join(' ');\n\t\treturn first ? firstName : lastName;\n\t};\n\tlet autoCompleteMapRaw = rcmail.crmContent.find('.js-mailAutoCompleteFields').val();\n\tlet autoCompleteMap = autoCompleteMapRaw ? JSON.parse(autoCompleteMapRaw) : [];\n\tif (autoCompleteMap && autoCompleteMap[moduleName]) {\n\t\tlet map = autoCompleteMap[moduleName];\n\t\tfor (let name in map) {\n\t\t\tif (map.hasOwnProperty(name) && map[name]) {\n\t\t\t\tswitch (map[name]) {\n\t\t\t\t\tcase 'fromNameFirstPart':\n\t\t\t\t\t\trelatedParams[name] = fillNameFields(true);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'fromNameSecondPart':\n\t\t\t\t\t\trelatedParams[name] = fillNameFields(false);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'fromName':\n\t\t\t\t\t\trelatedParams[name] = rcmail.env.yf_fromName;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'subject':\n\t\t\t\t\t\trelatedParams[name] = rcmail.env.yf_subject;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'email':\n\t\t\t\t\t\trelatedParams[name] = rcmail.env.yf_fromMail;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\trelatedParams['email'] = rcmail.env.yf_fromMail;\n\trelatedParams['email1'] = rcmail.env.yf_fromMail;\n\tlet messageBody = $('#messagebody .rcmBody').clone();\n\tmessageBody.find('.image-attachment').remove();\n\trelatedParams['description'] = messageBody.html();\n\t//relatedParams['related_to'] = record;\n\tif (params.relatedRecords !== undefined) {\n\t\trelatedParams['relatedRecords'] = params.relatedRecords;\n\t}\n\trelatedParams['sourceModule'] = sourceModule;\n\trelatedParams['sourceRecord'] = record;\n\trelatedParams['relationOperation'] = true;\n\tconst headerInstance = new rcmail.crm.Vtiger_Header_Js();\n\theaderInstance.quickCreateModule(moduleName, {\n\t\tcallbackFunction: (data) => {\n\t\t\trcmail.loadActionBar();\n\t\t},\n\t\tcallbackPostShown: postShown,\n\t\tdata: relatedParams,\n\t\tnoCache: true\n\t});\n};\nrcube_webmail.prototype.getCrmWindow = function () {\n\tif (opener !== null && opener.parent.CONFIG == 'object') {\n\t\treturn opener.parent;\n\t} else if (typeof parent.CONFIG == 'object') {\n\t\treturn parent;\n\t} else if (typeof parent.parent.CONFIG == 'object') {\n\t\treturn parent.parent;\n\t} else if (typeof opener.crm.CONFIG == 'object') {\n\t\treturn opener.crm;\n\t}\n\treturn false;\n};\n// Get raw mail body\nrcube_webmail.prototype.loadMailAnalysis = function (props) {\n\tthis.http_post('plugin.yetiforce-loadMailAnalysis', this.selection_post_data(), this.set_busy(true, 'loading'));\n};\n//Show mail analysis modal\nrcube_webmail.prototype.showMailAnalysis = function (content) {\n\tlet progressIndicatorElement = rcmail.crm.$.progressIndicator();\n\trcmail.crm.AppConnector.request({\n\t\tmodule: 'AppComponents',\n\t\tview: 'MailMessageAnalysisModal',\n\t\tcontent: content\n\t})\n\t\t.done(function (data) {\n\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\trcmail.crm.app.showModalWindow(data);\n\t\t})\n\t\t.fail(function () {\n\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t\trcmail.crm.app.showNotify({\n\t\t\t\ttext: rcmail.crm.app.vtranslate('JS_ERROR'),\n\t\t\t\ttype: 'error'\n\t\t\t});\n\t\t});\n};\n"],"names":["window","rcmail","addEventListener","crm","getCrmWindow","env","uid","loadActionBar","message_commands","push","register_command","props","type","importICS","addSenderToList","loadMailAnalysis","content","showMailAnalysis","message_list","list","enable_command","get_selection","length","$","mailbox","junk_mailbox","btns","hide","show","layout","gui_objects","messagelist","evt","row","obj","style","backgroundColor","yf_rblList","yf_senderList","prepend","html","rcube_webmail","prototype","http_post","selection_post_data","_props","set_busy","addSenderToListMove","mbox","move_messages","part","_mbox","_uid","_part","_type","_mailId","mailId","crmContent","AppConnector","request","module","view","folder","rcId","user_id","done","response","find","css","outerHeight","registerEvents","val","registerAddRecord","registerAddReletedRecord","registerSelectRecord","registerRemoveRecord","registerImportMail","app","registerPopover","closest","registerIframeAndMoreContent","click","icon","button","data","removeClass","addClass","block","toggle","trigger","importButton","clicked","showNotify","text","vtranslate","action","fail","e","removeRecord","currentTarget","getCacheModule","moduleCacheGet","relationSelect","moduleCacheSet","relParams","crmid","mod","newModule","showPopup","src_module","src_record","targetElement","showQuickCreateForm","sourceModule","selectValue","col","each","i","record","relatedRecords","id","async","dataType","mode","params","notifyParams","animation","actionsParams","showRecordsList","modal","instance","setSelectEvent","responseData","moduleName","relatedParams","appendTo","ids","link","process","subprocess","subprocess_sl","linkextend","value","element","JSON","parse","inArray","first","yf_fromName","split","firstName","nameData","shift","lastName","join","autoCompleteMapRaw","autoCompleteMap","map","hasOwnProperty","name","fillNameFields","yf_subject","yf_fromMail","clone","messageBody","remove","Vtiger_Header_Js","headerInstance","quickCreateModule","callbackFunction","callbackPostShown","postShown","noCache","parent","CONFIG","opener","progressIndicator","progressIndicatorElement","showModalWindow"],"mappings":"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"}