function rcube_mail_ui(){var j={};var f={};var N={forwardmenu:{editable:1},searchmenu:{editable:1,callback:q},attachmentmenu:{},listoptions:{editable:1},groupmenu:{above:1},mailboxmenu:{above:1},spellmenu:{callback:g},"folder-selector":{iconized:1}};var r=this;var D;var k;var P={};var T;this.set=x;this.init=Q;this.init_tabs=F;this.show_about=E;this.show_popup=M;this.toggle_popup=z;this.add_popup=a;this.set_searchmod=e;this.set_searchscope=C;this.show_uploadform=I;this.show_header_row=o;this.hide_header_row=S;this.update_quota=L;this.get_pref=R;this.save_pref=K;this.folder_search_init=i;if(window.$&&document.body){var B=R("minimalmode");if(parseInt(B)||(B===null&&$(window).height()<850)){$(document.body).addClass("minimal")}if(bw.tablet){$("#viewport").attr("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0")}$(document).ready(function(){r.init()})}function x(W,X){j[W]=X}function R(X){if(!T){T=rcmail.local_storage_get_item("prefs.larry",{})}if(T[X]==null){var W=rcmail.get_cookie(X);if(W!=null){T[X]=W;if(rcmail.local_storage_set_item("prefs.larry",T)){rcmail.set_cookie(X,W,new Date())}}}return T[X]}function K(W,Y){T[W]=Y;if(!rcmail.local_storage_set_item("prefs.larry",T)){var X=new Date();X.setYear(X.getFullYear()+1);rcmail.set_cookie(W,Y,X)}}function Q(){rcmail.addEventListener("message",H);$("#taskbar a").each(function(ai,aj){$(aj).append('<span class="tooltip">'+$(".button-inner",this).html()+"</span>")});$("#taskbar .minmodetoggle").click(function(aj){var ai=$(document.body).toggleClass("minimal").hasClass("minimal");K("minimalmode",ai?1:0);$(window).resize()});if(rcmail.env.task=="mail"){rcmail.addEventListener("menu-open",t).addEventListener("menu-close",t).addEventListener("menu-save",u).addEventListener("enable-command",V).addEventListener("responseafterlist",function(ai){c(rcmail.env.threading?"thread":"list",true)}).addEventListener("responseaftersearch",function(ai){c(rcmail.env.threading?"thread":"list",true)});var ae=$("#dragmessagemenu");if(ae.length){rcmail.gui_object("dragmenu","dragmessagemenu");f.dragmenu=ae}if(rcmail.env.action=="show"||rcmail.env.action=="preview"){rcmail.addEventListener("aftershow-headers",function(){l()}).addEventListener("afterhide-headers",function(){l()});$("#previewheaderstoggle").click(function(ai){A();if(this.blur&&!rcube_event.is_keyboard(ai)){this.blur()}return false});$("#attachment-list > li").each(function(){v(this)});if(R("previewheaders")=="1"){A()}if(rcmail.env.action=="show"){$("#messagecontent").focus()}}else{if(rcmail.env.action=="compose"){rcmail.addEventListener("aftersend-attachment",I).addEventListener("fileappended",function(ai){if(ai.attachment.complete){v(ai.item)}}).addEventListener("aftertoggle-editor",function(ai){window.setTimeout(function(){p()},200);if(ai&&ai.mode){$("select[name='editorSelector']").val(ai.mode)}}).addEventListener("compose-encrypted",function(ai){$("select[name='editorSelector']").prop("disabled",ai.active);$("a.button.attach, a.button.responses")[(ai.active?"addClass":"removeClass")]("disabled");$("#responseslist a.insertresponse")[(ai.active?"removeClass":"addClass")]("active")});var aa,af,ac,Z=["cc","bcc","replyto","followupto"];for(aa=0;aa<Z.length;aa++){af=Z[aa];ac=$("#_"+af);if(ac.length){ac.on("change",{v:af},function(ai){if(this.value){o(ai.data.v,true)}});if(ac.val()!=""){o(af,true)}}}$("#composeoptionstoggle").click(function(aj){var ai=$("#composeoptions").toggle().is(":visible");$("#composeoptionstoggle").toggleClass("remove").attr("aria-expanded",ai?"true":"false");p();K("composeoptions",ai?"1":"0");if(!rcube_event.is_keyboard(aj)){this.blur()}return false}).css("cursor","pointer");if(R("composeoptions")!=="0"){$("#composeoptionstoggle").click()}$("textarea[name='_to'], textarea[name='_cc'], textarea[name='_bcc']").change(function(ai){w(this)}).change();rcmail.addEventListener("autocomplete_insert",function(ai){w(ai.field)});var ab=rcmail.opener();if(ab&&ab.env.action=="compose"&&$("#composeoptionstoggle",opener.document).hasClass("remove")){$("#composeoptionstoggle").click()}new rcube_splitter({id:"composesplitterv",p1:"#composeview-left",p2:"#composeview-right",orientation:"v",relative:true,start:206,min:170,size:12,render:p}).init();$("#attachment-list > li").each(function(){v(this)})}else{if(rcmail.env.action=="list"||!rcmail.env.action){J();var X=$("#mailpreviewframe");var ah=X.data("type");var W=X.is(":visible");$("#mailpreviewtogglebtn .mailpreviewtoggle").each(function(ak,aj){var ai=$(aj);if(W&&ai.data("type")==ah){ai.addClass("enabled").attr("aria-expanded","true")}else{ai.addClass("closed").attr("aria-expanded","false")}}).click(function(ai){d(ai);return false});$("#maillistmode").addClass(rcmail.env.threading?"":"selected").click(function(ai){c("list");return false});$("#mailthreadmode").addClass(rcmail.env.threading?"selected":"").click(function(ai){c("thread");return false});D={v:new rcube_splitter({id:"mailviewsplitter_v",p1:"#mailview-top",p2:"#mailview-bottom",orientation:"v",relative:true,start:276,min:560,size:12,offset:4}),h:new rcube_splitter({id:"mailviewsplitter_h",p1:"#mailview-top",p2:"#mailview-bottom",orientation:"h",relative:true,start:276,min:150,size:12,offset:4})};if(W&&D[ah]!=undefined){D[ah].init()}rcmail.init_pagejumper("#pagejumper");rcmail.addEventListener("setquota",L).addEventListener("layout-change",J).addEventListener("afterimport-messages",I)}else{if(rcmail.env.action=="get"){new rcube_splitter({id:"mailpartsplitterv",p1:"#messagepartheader",p2:"#messagepartcontainer",orientation:"v",relative:true,start:226,min:150,size:12}).init()}}}}if($("#mailview-left").length){new rcube_splitter({id:"mailviewsplitterv",p1:"#mailview-left",p2:"#mailview-right",orientation:"v",relative:true,start:206,min:150,size:12,callback:n,render:O}).init()}}else{if(rcmail.env.task=="settings"){rcmail.addEventListener("init",function(){var ai="#settingstabpreferences";if(rcmail.env.action){ai="#settingstab"+(rcmail.env.action.indexOf("identity")>0?"identities":rcmail.env.action.replace(/\./g,""))}$(ai).addClass("selected").children().first().removeAttr("onclick").click(function(){return false})});if(rcmail.env.action=="folders"){new rcube_splitter({id:"folderviewsplitter",p1:"#folderslist",p2:"#folder-details",orientation:"v",relative:true,start:266,min:180,size:12}).init();rcmail.addEventListener("setquota",L);i($("#folderslist"))}else{if(rcmail.env.action=="identities"){new rcube_splitter({id:"identviewsplitter",p1:"#identitieslist",p2:"#identity-details",orientation:"v",relative:true,start:266,min:180,size:12}).init()}else{if(rcmail.env.action=="responses"){new rcube_splitter({id:"responseviewsplitter",p1:"#identitieslist",p2:"#identity-details",orientation:"v",relative:true,start:266,min:180,size:12}).init()}else{if(rcmail.env.action=="preferences"||!rcmail.env.action){new rcube_splitter({id:"prefviewsplitter",p1:"#sectionslist",p2:"#preferences-box",orientation:"v",relative:true,start:266,min:180,size:12}).init()}else{if(rcmail.env.action=="edit-prefs"){var ad=$("#preferences-details fieldset.advanced legend"),Y=$('<a href="#toggle"></a>').text(rcmail.gettext("toggleadvancedoptions")).attr("title",rcmail.gettext("toggleadvancedoptions")).addClass("advanced-toggle");ad.click(function(ai){Y.html($(this).hasClass("collapsed")?"&#9650;":"&#9660;");$(this).toggleClass("collapsed").closest("fieldset").children(".propform").toggle()}).append(Y).addClass("collapsed");if(bw.mz){ad.parents("form").css("display","inline")}}}}}}}else{if(rcmail.env.task=="addressbook"){rcmail.addEventListener("afterupload-photo",I).addEventListener("beforepushgroup",G).addEventListener("beforepopgroup",U).addEventListener("menu-open",t).addEventListener("menu-close",t);if(rcmail.env.action==""){new rcube_splitter({id:"addressviewsplitterd",p1:"#addressview-left",p2:"#addressview-right",orientation:"v",relative:true,start:206,min:150,size:12,render:O}).init();new rcube_splitter({id:"addressviewsplitter",p1:"#addresslist",p2:"#contacts-box",orientation:"v",relative:true,start:266,min:260,size:12}).init()}var ae=$("#dragcontactmenu");if(ae.length){rcmail.gui_object("dragmenu","dragcontactmenu");f.dragmenu=ae}}}}$(".tabbed").each(function(ai,aj){F(aj)});$("select.decorated").each(function(){if(bw.opera){$(this).removeClass("decorated");return}var aj=$(this),am=aj.parent(),ai=Math.max(aj.height(),26)-2,al=aj.width()-22,an=$("option",this).first().text();if($("option:selected",this).val()!=""){an=$("option:selected",this).text()}var ak=$('<a class="menuselector" tabindex="-1"><span class="handle">'+an+"</span></a>").css("position","absolute").offset(aj.position()).insertAfter(aj);ak.children().width(al).height(ai).css("line-height",(ai-1)+"px");if(am.css("position")!="absolute"){am.css("position","relative")}aj.width(ak.width()).on(bw.mz?"change keyup":"change",function(){var ao=$("option:selected",this).text();$(this).next().children().text(ao)});aj.on("focus",function(ao){ak.addClass("focus")}).on("blur",function(ao){ak.removeClass("focus")})});var ag=$("body.minwidth");if(ag.length){ag.css("min-width",$(".toolbar").width()+$("#quicksearchbar").width()+$("#searchfilter").width()+30)}window.onresize=s;s()}function s(X){var W=X?10:0;if(rcmail.resize_timeout){window.clearTimeout(rcmail.resize_timeout)}rcmail.resize_timeout=window.setTimeout(function(){if(rcmail.env.task=="mail"){if(rcmail.env.action=="show"||rcmail.env.action=="preview"){l()}else{if(rcmail.env.action=="compose"){p()}}}$("body.iframe .footerleft").each(function(){var ac=$(this),Y=$(document.body),ab=ac.hasClass("floating"),aa=Y.outerHeight(true)>$(window).height();if(aa!=ab){var Z=aa?"addClass":"removeClass";ac[Z]("floating");Y[Z]("floatingbuttons")}})},W)}function H(X){var Z=$(X.object).siblings("div");if(Z.length){$(X.object).insertBefore(Z.first())}if(X.type=="error"&&rcmail.env.task!="login"){rcmail.hide_message(X.object);if(r.message_timer){window.clearTimeout(r.message_timer)}if(!r.messagedialog){r.messagedialog=$("<div>").addClass("popupdialog").hide()}var Y=X.message,W=function(){r.messagedialog.is(":visible")&&r.messagedialog.dialog("destroy").hide()};if(r.messagedialog.is(":visible")&&r.messagedialog.text()!=Y){Y=r.messagedialog.html()+"<p>"+X.message+"</p>"}r.messagedialog.html(Y).dialog({resizable:false,closeOnEscape:true,dialogClass:X.type,title:rcmail.gettext("errortitle"),close:W,hide:{effect:"fadeOut"},width:420,minHeight:90}).show();r.messagedialog.closest("div[role=dialog]").attr("role","alertdialog");if(X.timeout>0){r.message_timer=window.setTimeout(W,X.timeout)}}}function J(Z){var X=Z?Z.new_layout:rcmail.env.layout,Y=$("#mailview-top"),W=$("#mailview-bottom");if(Z){$("#mainscreencontent").removeClass().addClass(X)}$("#mailviewsplitter")[X=="desktop"?"show":"hide"]();$("#mailviewsplitter2")[X=="widescreen"?"show":"hide"]();$("#mailpreviewframe")[X!="list"?"show":"hide"]();rcmail.env.contentframe=X=="list"?null:"messagecontframe";if(X=="widescreen"){$("#countcontrols").detach().appendTo($("#messagelistheader"));Y.css({height:"auto",width:394});W.css({top:0,left:406,height:"auto"}).show();if(!k){k=new rcube_splitter({id:"mailviewsplitter2",p1:"#mailview-top",p2:"#mailview-bottom",orientation:"v",relative:true,start:416,min:400,size:12});k.init()}else{k.resize()}}else{if(X=="desktop"){Y.css({height:270,width:"auto"});W.css({left:0,top:284,height:"auto"}).show();if(!D){D=new rcube_splitter({id:"mailviewsplitter",p1:"#mailview-top",p2:"#mailview-bottom",orientation:"h",relative:true,start:276,min:150,size:12,offset:4});D.init()}else{D.resize()}}else{Y.css({height:"auto",width:"auto"});W.hide()}}if(Z&&Z.old_layout=="widescreen"){$("#countcontrols").detach().appendTo($("#messagelistfooter"))}}function l(){$("#messagecontent").css("top",($("#ytActionBarContent").outerHeight()+$("#messageheader").outerHeight())+"px");$("#message-objects div a").addClass("button");if(!$("#attachment-list li").length){$("div.rightcol").hide().attr("aria-hidden","true");$("div.leftcol").css("margin-right","0")}var W=$("#messagebody.mailvelope, #messagebody > .mailvelope");if(W.length){var X=$("#messagecontent").length?$("#messagecontent").height()-16:$(window).height()-W.offset().top-2;W.height(X)}}function n(W){}function O(W){}function w(Y){if(Y.nodeName=="TEXTAREA"){var X=$(Y),aa=14,W=Y.scrollHeight,Z=Y.value.length>80&&W>aa*1.5?2:1;X.css("height",(aa*Z)+"px");p()}}function p(){var ac=$("#composebody"),X=$("#compose-content"),W=$("#composeview-bottom"),ad,ab,aa,af,Z=0,ae=300,aa=X.height()-W.position().top;af=ae-aa;Z=af>-100?0:40;W.height(Math.max(ae,aa));X.css("overflow",af>0?"auto":"hidden");ad=ac.parent().width()-5;ab=ac.parent().height()-8;ac.width(ad).height(ab);$("#composebodycontainer > div").width(ad+8);$("#composebody_ifr").height(ab+4-$("div.mce-toolbar").height());$("#googie_edit_layer").width(ad).height(ab);var Y=$("#directorylist");if(Y.length){$("#compose-contacts .scroller").css("top",Y.position().top+Y.outerHeight())}}function L(Z){var W=$("#quotadisplay"),aa=$("#quotamenu"),X=24,Y=20,ab=Z.total?Math.ceil(Z.percent/100*Y)*X:0;if(Z.total&&ab==X*Y&&Z.percent<100){ab-=X}W.css("background-position","0 -"+ab+"px");W.attr("class","countdisplay p"+(Math.round(Z.percent/10)*10));if(Z.table){if(!aa.length){aa=$('<div id="quotamenu" class="popupmenu">').appendTo($("body"))}aa.html(Z.table);W.css("cursor","pointer").off("click").on("click",function(ac){return rcmail.command("menu-open","quotamenu",ac.target,ac)})}}function i(W){$(".boxtitle a.search",W).click(function(aa){var ab=$(".boxtitle",W),Z=$(".listsearchbox",W),Y=Z.is(":visible")?-1:1,X=34+($("select",Z).length?22:0);Z.slideToggle({duration:160,progress:function(ad,ac){if(Y<0){ac=1-ac}$(".scroller",W).css("top",(ab.outerHeight()+X*ac)+"px")},complete:function(){Z.toggleClass("expanded");if(Z.is(":visible")){Z.find("input[type=text]").focus();X=34+($("select",Z).length?$("select",Z).outerHeight()+4:0);$(".scroller",W).css("top",(ab.outerHeight()+X)+"px")}else{$("a.reset",Z).click()}}});return false})}function V(X){if(X.command=="reply-list"&&rcmail.env.reply_all_mode==1){var W=rcmail.gettext(X.status?"replylist":"replyall");if(rcmail.env.action=="preview"){$("a.button.replyall").attr("title",W)}else{$("a.button.reply-all").text(W).attr("title",W)}}else{if(X.command=="compose-encrypted"){$("a.button.encrypt").show()}}}function a(W,X){var Y=f[W]=$("#"+W);Y.appendTo(document.body);if(Y.length){N[W]=$.extend(N[W]||{},X||{})}}function z(W,Y,X){if(X||!N[W]){a(W,X)}return rcmail.command("menu-open",W,Y.target,Y)}function M(X,W,Y){if(Y||!N[X]){a(X,Y)}Y=N[X]||{};var Z=$(Y.link?Y.link:"#"+X+"link"),aa=Z.offset();if(Z.has(".inner")){Z=Z.children(".inner")}return rcmail.command("menu-open",{menu:X,show:W},Z.get(0),$.Event("click",{target:Z.get(0),pageX:aa.left,pageY:aa.top,clientX:aa.left,clientY:aa.top}))}function d(ad){var aa=$(ad.currentTarget),ae=aa.data("type"),Y=$("#mailpreviewframe"),Z=!Y.is(":visible"),X=D[ae],W,af,ac,ab;Y.toggle();aa.toggleClass("enabled closed").attr("aria-expanded",Z?"true":"false");if(ae=="v"){ab={height:"auto",width:"auto"};if(D.h.handle){D.h.handle.hide()}if(!$("#mailview-right").hasClass("verticalPanel")){$("#mailview-right").addClass("verticalPanel")}}else{ab={width:"auto",height:"auto",left:"0"};if(D.v.handle){D.v.handle.hide()}if($("#mailview-right").hasClass("verticalPanel")){$("#mailview-right").removeClass("verticalPanel")}}if(Z){$("#mailview-top").removeClass("fullheight").css({bottom:"auto"});$("#mailview-bottom").css(ab).show();rcmail.env.contentframe="messagecontframe";if(ac=rcmail.message_list.get_single_selection()){rcmail.show_message(ac,false,true)}if(X.handle){X.handle.show();X.resize()}else{X.init()}if(ae=="v"){$('#mailpreviewtogglebtn .mailpreviewtoggle[data-type="h"]').hide()}else{$('#mailpreviewtogglebtn .mailpreviewtoggle[data-type="v"]').hide()}}else{rcmail.env.contentframe=null;rcmail.show_contentframe(false);$("#mailview-top").addClass("fullheight").css($.extend({bottom:"0px"},ab));ab[Object.keys(ab)[0]]="0px";$("#mailview-bottom").css($.extend({top:"auto"},ab)).hide();if(X.handle){X.handle.hide()}if(ae=="v"){$('#mailpreviewtogglebtn .mailpreviewtoggle[data-type="h"]').show()}else{$('#mailpreviewtogglebtn .mailpreviewtoggle[data-type="v"]').show()}}if(rcmail.message_list){if(Z&&ac){rcmail.message_list.scrollto(ac)}rcmail.message_list.resize()}rcmail.command("save-pref",{name:"preview_pane",value:(Z?ae:0)})}function A(){$("#preview-shortheaders").toggle();var X=$("#preview-allheaders").toggle(),W=$("a#previewheaderstoggle");if(X.is(":visible")){W.attr("href","#hide").removeClass("add").addClass("remove").attr("aria-expanded","true")}else{W.attr("href","#details").removeClass("remove").addClass("add").attr("aria-expanded","false")}K("previewheaders",X.is(":visible")?"1":"0")}function c(X,W){if(W||!$("#mail"+X+"mode").hasClass("disabled")){$("#maillistmode, #mailthreadmode").removeClass("selected").attr("tabindex","0").attr("aria-disabled","false");$("#mail"+X+"mode").addClass("selected").attr("tabindex","-1").attr("aria-disabled","true")}}function t(ab){if(ab&&ab.name=="messagelistmenu"){m(ab)}else{if(ab){var X=N[ab.name]||{},Z=$(X.link||"#"+ab.name+"link"),ac=ab.obj&&ab.obj.is(":visible"),W=X.above;if(ab.obj&&ac&&Z.length){var Y=Z.parent(),aa=$(window),ad;if(Y.hasClass("dropbutton")){Z=Y}if(X.above||Z.hasClass("dropbutton")){ad=Z.offset();ab.obj.css({left:ad.left+"px",top:(ad.top+(X.above?-ab.obj.height():Z.outerHeight()))+"px"})}}if(ab.obj&&X.iconized){ab.obj.children("ul").addClass("iconized")}if(ab.obj&&X.editable){ab.obj.attr("data-editable","true")}if(typeof X.callback=="function"){X.callback(ac,ab)}}}}function q(W){if(W&&rcmail.env.search_mods){var ad,Y,ab=f.searchmenu,aa=$('input:checkbox[name="s_mods[]"]',ab),ac=rcmail.env.mailbox,Z=rcmail.env.search_mods,X=rcmail.env.search_scope||"base";if(rcmail.env.task=="mail"){if(X=="all"){ac="*"}Z=Z[ac]?Z[ac]:Z["*"];Y="text";$('input:radio[name="s_scope"]').prop("checked",false).filter("#s_scope_"+X).prop("checked",true)}else{Y="*"}if(Z[Y]){aa.map(function(){this.checked=true;this.disabled=this.value!=Y})}else{aa.prop("disabled",false).prop("checked",false);for(ad in Z){$("#s_mod_"+ad).prop("checked",true)}}}}function y(X,W){var Y=X.parentNode.id.replace(/^attach/,"");$.each(["open","download","rename"],function(){var Z=this;$("#attachmenu"+Z).off("click").attr("onclick","").click(function(aa){return rcmail.command(Z+"-attachment",Y,this)})});N.attachmentmenu.link=X;rcmail.command("menu-open",{menu:"attachmentmenu",id:Y},X,W)}function g(X,ab){var Y,aa,W,ac=rcmail.spellcheck_lang(),Z=$("ul",ab.obj);if(!Z.length){Z=$('<ul class="toolbarmenu selectable" role="menu">');for(Y in rcmail.env.spell_langs){W=$('<li role="menuitem">');aa=$('<a href="#'+Y+'" tabindex="0"></a>').text(rcmail.env.spell_langs[Y]).addClass("active").data("lang",Y).on("click keypress",function(ad){if(ad.type!="keypress"||rcube_event.get_keycode(ad)==13){rcmail.spellcheck_lang_set($(this).data("lang"));rcmail.hide_menu("spellmenu",ad);return false}});aa.appendTo(W);W.appendTo(Z)}Z.appendTo(ab.obj)}$("li",Z).each(function(){var ad=$("a",this);if(ad.data("lang")==ac){ad.addClass("selected").attr("aria-selected","true")}else{if(ad.hasClass("selected")){ad.removeClass("selected").removeAttr("aria-selected")}}})}function v(W){W=$(W);if(!W.children(".drop").length){W.append($('<a class="drop skip-content" tabindex="0" aria-haspopup="true">Show options</a>').on("click keypress",function(X){if(X.type!="keypress"||rcube_event.get_keycode(X)==13){y(this,X);return false}}))}}function m(X){var W=$("#listoptions");if(W.is(":visible")){W.dialog("close",X.originalEvent);return}$('input[name="sort_col"][value="'+rcmail.env.sort_col+'"]').prop("checked",true);$('input[name="sort_ord"][value="DESC"]').prop("checked",rcmail.env.sort_order=="DESC");$('input[name="sort_ord"][value="ASC"]').prop("checked",rcmail.env.sort_order!="DESC");$.each(["widescreen","desktop","list"],function(){$('input[name="layout"][value="'+this+'"]').prop("checked",rcmail.env.layout==this)});$("#listoptions-columns",W)[rcmail.env.layout=="widescreen"?"hide":"show"]();$('input[name="list_col[]"]').each(function(){$(this).prop("checked",$.inArray(this.value,rcmail.env.listcols)!=-1)});W.dialog({modal:true,resizable:false,closeOnEscape:true,title:null,open:function(Y){setTimeout(function(){W.find("a, input:not(:disabled)").not("[aria-disabled=true]").first().focus()},100)},close:function(Y){W.dialog("destroy").hide();if(Y.originalEvent&&rcube_event.is_keyboard(Y.originalEvent)){$("#listmenulink").focus()}},minWidth:500,width:W.width()+25}).show()}function u(aa){$("#listoptions").dialog("close");if(rcube_event.is_keyboard(aa.originalEvent)){$("#listmenulink").focus()}var X=$('input[name="sort_col"]:checked').val(),W=$('input[name="sort_ord"]:checked').val(),Y=$('input[name="layout"]:checked').val(),Z=$('input[name="list_col[]"]:checked').map(function(){return this.value}).get();rcmail.set_list_options(Z,X,W,rcmail.env.threading,Y)}function e(ab){var Z,W,X=rcmail.env.task,aa=rcmail.env.search_mods,ac=rcmail.env.mailbox,Y=$('input[name="s_scope"]:checked').val();if(Y=="all"){ac="*"}if(!aa){aa={}}if(X=="mail"){if(!aa[ac]){aa[ac]=rcube_clone_object(aa["*"])}W=aa[ac];Z="text"}else{W=aa;Z="*"}if(!ab.checked){delete (W[ab.value])}else{W[ab.value]=1}if(ab.value==Z){$('input:checkbox[name="s_mods[]"]').map(function(){if(this==ab){return}this.checked=true;if(ab.checked){this.disabled=true;delete W[this.value]}else{this.disabled=false;W[this.value]=1}})}rcmail.set_searchmods(W)}function C(W){rcmail.set_searchscope(W.value)}function G(Y){var X=$("#contacts-table"),W=X.parent().css("overflow","hidden");X.clone().css({position:"absolute",top:"0",left:"0",width:X.width()+"px","z-index":10}).appendTo(W).animate({left:-(X.width()+5)+"px"},300,"swing",function(){$(this).remove();W.css("overflow","auto")})}function U(Y){var X=$("#contacts-table"),W=X.parent().css("overflow","hidden"),Z=X.clone().appendTo(W);X.css({position:"absolute",top:"0",left:-(X.width()+5)+"px",width:X.width()+"px",height:X.height()+"px","z-index":10}).animate({left:"0"},300,"linear",function(){Z.remove();$(this).css({position:"relative",left:"0",width:"100%",height:"auto","z-index":1});W.css("overflow","auto")})}function I(X){var W=$("#upload-dialog");if(W.is(":visible")){W.dialog("close");return}if(rcmail.mailvelope_editor){return}if(rcmail.env.action=="compose"&&!W.data("extended")){$("<a>").addClass("iconlink add").attr("href","#add").html("Add").appendTo($('input[type="file"]',W).parent()).click(b);W.data("extended",true)}W.dialog({modal:true,resizable:false,closeOnEscape:true,title:W.attr("title"),open:function(Y){if(!document.all){$("input[type=file]",W).first().click()}},close:function(){try{$("#upload-dialog form").get(0).reset()}catch(Y){}W.dialog("destroy").hide();$("div.addline",W).remove()},width:480}).show()}function b(W){var Y=$(this).parent();var X=Y.clone().addClass("addline").insertAfter(Y);X.children(".iconlink").click(b);X.children("input").val("");if(!document.all){$("input[type=file]",X).click()}}function o(Y,W){var X=$("#compose-"+Y);if(X.is(":visible")){return}if(P[Y]&&!W){$("#_"+Y).val(P[Y])}X.show();$("#"+Y+"-link").hide();p();$("input,textarea",X).focus();return false}function S(X){var W=$("#_"+X);P[X]=W.val();W.val("");$("#compose-"+X).hide();$("#"+X+"-link").show();p();return false}function F(Z,aa){var Y=$(Z),ab=Y.get(0).id,W=Y.children("fieldset");if(!W.length){return}if(!ab){ab="rcmtabcontainer";Y.attr("id",ab)}var X=$("<ul>").addClass("tabsbar").prependTo(Y);W.each(function(ac){var af,ad,ah=$(this),ae=ah.children("legend"),ag=ab+"-t"+ac;ad=$("<a>").text(ae.text()).attr("href","#"+ag);af=$("<li>").addClass("tablink");ae.remove();ah.attr("id",ag);af.append(ad).appendTo(X)});Y.tabs({active:aa||0,heightStyle:"content",activate:function(ad,ac){s()}})}function E(W){var X=$("<iframe>").attr({id:"aboutframe",src:rcmail.url("settings/about"),frameborder:"0"});h=Math.floor($(window).height()*0.75),buttons={},supportln=$("#supportlink");if(supportln.length&&(j.supporturl=supportln.attr("href"))){buttons[supportln.html()]=function(Y){j.supporturl.indexOf("mailto:")<0?window.open(j.supporturl):location.href=j.supporturl}}X.dialog({modal:true,resizable:false,closeOnEscape:true,title:W?W.title||W.innerHTML:null,close:function(){X.dialog("destroy").remove()},buttons:buttons,width:640,height:h}).width(640)}}function rcube_scroller(c,d,a){var b=this;this.list=$(c);this.top=$(d);this.bottom=$(a);this.step_size=6;this.step_time=20;this.delay=500;this.top.mouseenter(function(){if(rcmail.drag_active){b.ts=window.setTimeout(function(){b.scroll("down")},b.delay)}}).mouseout(function(){if(b.ts){window.clearTimeout(b.ts)}});this.bottom.mouseenter(function(){if(rcmail.drag_active){b.ts=window.setTimeout(function(){b.scroll("up")},b.delay)}}).mouseout(function(){if(b.ts){window.clearTimeout(b.ts)}});this.scroll=function(e){var g=this,f=this.step_size;if(!rcmail.drag_active){return}if(e=="down"){f*=-1}this.list.get(0).scrollTop+=f;this.ts=window.setTimeout(function(){g.scroll(e)},this.step_time)}}function rcube_splitter(f){this.p=f;this.id=f.id;this.horizontal=(f.orientation=="horizontal"||f.orientation=="h");this.halfsize=(f.size!==undefined?f.size:10)/2;this.pos=f.start||0;this.min=f.min||20;this.offset=f.offset||0;this.relative=f.relative?true:false;this.drag_active=false;this.render=f.render;this.callback=f.callback;var d=this;rcube_splitter._instances[this.id]=d;this.init=function(){this.p1=$(this.p.p1);this.p2=$(this.p.p2);this.parent=this.p1.parent();if(!this.p1.length||!this.p2.length){return}this.p1pos=this.relative?this.p1.position():this.p1.offset();this.p2pos=this.relative?this.p2.position():this.p2.offset();this.handle=$("<div>").attr("id",this.id).attr("unselectable","on").attr("role","presentation").addClass("splitter "+(this.horizontal?"splitter-h":"splitter-v")).appendTo(this.parent).mousedown(e);if(this.horizontal){var k=this.p1pos.top+this.p1.outerHeight();this.handle.css({left:"0px",top:k+"px"})}else{var j=this.p1pos.left+this.p1.outerWidth();this.handle.css({left:j+"px",top:"0px"})}if(bw.ie){$(window).resize(c)}var i=this.get_cookie();if(i&&!isNaN(i)){this.pos=parseFloat(i);this.resize()}else{if(this.pos){this.resize();this.set_cookie()}}};this.resize=function(){if(this.horizontal){this.p1.css("height",Math.floor(this.pos-this.p1pos.top-Math.floor(this.halfsize))+"px");this.p2.css("top",Math.ceil(this.pos+Math.ceil(this.halfsize)+2)+"px");this.handle.css("top",Math.round(this.pos-this.halfsize+this.offset)+"px");if(bw.ie){var j=parseInt(this.parent.outerHeight(),10)-parseInt(this.p2.css("top"),10);this.p2.css("height",(j>0?j:0)+"px")}}else{this.p1.css("width",Math.floor(this.pos-this.p1pos.left-Math.floor(this.halfsize))+"px");this.p2.css("left",Math.ceil(this.pos+Math.ceil(this.halfsize))+"px");this.handle.css("left",Math.round(this.pos-this.halfsize+this.offset+3)+"px");if(bw.ie){var i=parseInt(this.parent.outerWidth(),10)-parseInt(this.p2.css("left"),10);this.p2.css("width",(i>0?i:0)+"px")}}this.p2.resize();this.p1.resize();if(this.drag_active){$("iframe").each(function(k,l){var m=$(this).offset();$("#iframe-splitter-fix-"+k).css({top:m.top+"px",left:m.left+"px",width:l.offsetWidth+"px",height:l.offsetHeight+"px"})})}if(typeof this.render=="function"){this.render(this)}};function e(i){if(bw.konq||bw.chrome||bw.safari){document.body.style.webkitUserSelect="none"}d.p1pos=d.relative?d.p1.position():d.p1.offset();d.p2pos=d.relative?d.p2.position():d.p2.offset();d.drag_active=true;$(document).on("mousemove."+this.id,a).on("mouseup."+this.id,g);if(rcmail.message_list){rcmail.message_list.drag_active=true}$("iframe").each(function(j,k){$("<div>").attr("id","iframe-splitter-fix-"+j).addClass("iframe-splitter-fix").css({background:"#fff",width:k.offsetWidth+"px",height:k.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css($(this).offset()).appendTo("body")})}function a(i){if(!d.drag_active){return false}window.clearTimeout(d.ts);d.ts=window.setTimeout(function(){b(i)},1);return false}function b(j){var k=rcube_event.get_mouse_pos(j);if(d.relative){var i=d.parent.offset();k.x-=i.left;k.y-=i.top}if(d.horizontal){if(((k.y-d.halfsize)>d.p1pos.top)&&((k.y+d.halfsize)<(d.p2pos.top+d.p2.outerHeight()))){d.pos=Math.max(d.min,k.y-Math.max(0,d.offset));if(d.pos>d.min){d.pos=Math.min(d.pos,d.parent.height()-d.min)}d.resize()}}else{if(((k.x-d.halfsize)>d.p1pos.left)&&((k.x+d.halfsize)<(d.p2pos.left+d.p2.outerWidth()))){d.pos=Math.max(d.min,k.x-Math.max(0,d.offset));if(d.pos>d.min){d.pos=Math.min(d.pos,d.parent.width()-d.min)}d.resize()}}d.p1pos=d.relative?d.p1.position():d.p1.offset();d.p2pos=d.relative?d.p2.position():d.p2.offset()}function g(i){if(bw.konq||bw.chrome||bw.safari){document.body.style.webkitUserSelect="auto"}$(document).off("."+d.id);d.drag_active=false;if(rcmail.message_list){rcmail.message_list.drag_active=false}$("div.iframe-splitter-fix").remove();d.set_cookie();if(typeof d.callback=="function"){d.callback(d)}return bw.safari?true:rcube_event.cancel(i)}function c(k){if(d.horizontal){var j=parseInt(d.parent.outerHeight(),10)-parseInt(d.p2[0].style.top,10);d.p2.css("height",(j>0?j:0)+"px")}else{var i=parseInt(d.parent.outerWidth(),10)-parseInt(d.p2[0].style.left,10);d.p2.css("width",(i>0?i:0)+"px")}}this.get_cookie=function(){return window.UI?UI.get_pref(this.id):null};this.set_cookie=function(){if(window.UI){UI.save_pref(this.id,this.pos)}}}rcube_splitter._instances={};rcube_splitter.get_instance=function(a){return rcube_splitter._instances[a]};